!function(e){function a(n){if(t[n])return t[n].exports;var r=t[n]={exports:{},id:n,loaded:!1};return e[n].call(r.exports,r,r.exports,a),r.loaded=!0,r.exports}var t={};return a.m=e,a.c=t,a.p="",a(0)}([function(e,a){!function(e){function a(e,a){return e.hasOwnProperty(a)&&a in e}var t=function(e,a){var t,n=[];for(t=0;t<e;t+=1)n[t]=a+t;return n},n=function(t,n){var r="";return e.each(n,function(n,o){var i,c=/\{(.*?)\}/g,g=t.match(c),p=t;e.each(g,function(e,t){i=t.replace(/\{(.*?)\}/g,"$1"),p=p.replace(t,a(o,i)?o[i]:"<span style='color:red'>无此字段："+i+"</span>")}),r+=p}),r},r=function(a){var n={currentPage:1,pageSize:20,totalRecords:0,pageTemplate:"<div>当前页: [page:page], 总页数: [page:pages]，<ul class='pageNav'>[page:pageLink]</ul></div>",pageLinkTemplate:"<li data-page='[page:pageNum]'>[page:pageNum]</li>"};return e.extend(n,a),function(a){var n=Math.ceil(a.totalRecords/a.pageSize);if(!(n<2)){var r=a.pageTemplate,o="",i="",c="",g="",p="",l="",d="";return n>10||(i=t(n,1)),n>10&&(a.currentPage<=10&&(i=t(10,1)),a.currentPage>10&&(i=a.currentPage<=n-5?t(10,a.currentPage-4):t(10,n-9))),e.each(i,function(e,t){d+=a.pageLinkTemplate.replace(/\[page:pageNum\]/g,t)}),p="<li data-page='[page:pageNum]'>&lt;&lt;</li>".replace(/\[page:pageNum\]/g,1),c="<li data-page='[page:pageNum]'>&lt;</li>".replace(/\[page:pageNum\]/g,parseInt(a.currentPage)-1),g="<li data-page='[page:pageNum]'>&gt;</li>".replace(/\[page:pageNum\]/g,parseInt(a.currentPage)+1>n?n:parseInt(a.currentPage)+1),l="<li data-page='[page:pageNum]'>&gt;&gt;</li>".replace(/\[page:pageNum\]/g,n),1===a.currentPage&&(p="",c=""),parseInt(a.currentPage)===n&&(g="",l=""),o=p+c+d+g+l,r=r.replace(/\[page\:pages\]/g,n).replace(/\[page\:page\]/g,a.currentPage?a.currentPage:1).replace(/\[page\:pageLink\]/g,o)}}(n)},o={init:function(){},list:function(a,t){var o={isPage:!1,isMobile:!1,pageSize:20,currentPage:1,totalRecords:0};o.isMobile=/(iemobile|iphone|ipod|android|nokia|sonyericsson|blackberry|samsung|sec\-|windows ce|motorola|mot\-|up.b|midp\-)/gi.test(navigator.appVersion),e.extend(o,a);var i="#"+this.attr("id"),c=i+"Template",g="";e(c)[0]?g=e(c).html():(g=e(i).html(),e("body").append("<div id='"+c.slice(1)+"' class='hide'></div>"),e(c).html(g));var p="<div class='loading'>"+e(i).attr("data-loadInfo")+"</div>";1==o.currentPage&&e(i).before(p).removeClass("hide");var l=function(a,t){var n=e(i).attr("data-jsonUrl");return n=n.indexOf("page")>-1?n.replace(/page=(\d+)*/g,"page="+a):n.indexOf("?")>-1?n+"&page="+a:n+"?page="+a,n=n.indexOf("pageSize")>-1?n.replace(/pageSize=(\d+)*/g,"pageSize="+t):n.indexOf("?")>-1?n+"&pageSize="+t:n+"?pageSize="+t},d=this.attr("data-jsonUrl");d=l(o.currentPage,o.pageSize),console.log(d),e.getJSON(d,function(a){var c=n(g,a.data);if(o.totalRecords=a.totalRecord,o.isMobile&&o.currentPage>1?(e(i).prev(".loading").remove(),e(i).append(c)):(e(i).prev(".loading").remove(),e(i).html(c)),o.isPage){var p=Math.ceil(o.totalRecords/o.pageSize);if(o.totalRecords=a.totalRecord,o.isMobile){var d,u,s,m,f,v=function(){var e=0,a=0,t=0;return document.body&&(a=document.body.scrollTop),document.documentElement&&(t=document.documentElement.scrollTop),e=a-t>0?a:t},h=function(){var e=0;return e="CSS1Compat"==document.compatMode?document.documentElement.clientHeight:document.body.clientHeight},P=function(){var e=0,a=0,t=0;return document.body&&(a=document.body.scrollHeight),document.documentElement&&(t=document.documentElement.scrollHeight),e=a-t>0?a:t},b=function(){setTimeout(function(){e(i).next().remove()},1e3)},y=function(){o.currentPage<p?e(".loading")[0]||e(i).after("<div class='loading'>载入中……</div>"):e(i).next().hasClass("loadEnd")||e(i).after("<div class='loadEnd'>已经是底部</div>")},S=function(){if(o.currentPage<p){l(o.currentPage,o.pageSize);e(i).attr("data-jsonUrl",l(o.currentPage,o.pageSize)),e("body").unbind("touchend"),o.currentPage+=1,e(i).bindJSON("list",o,t)}},N=function(){if(v()<h()&&1===o.currentPage&&p>1){var a=l(2,o.pageSize);e(i).attr("data-jsonUrl",a),o.currentPage=2,e(i).bindJSON("list",o,t)}},x=document.querySelector("body");x.addEventListener("touchstart",function(e){var a=e.touches[0];d={x:a.pageX,y:a.pageY}}),e("body").bind("touchend",function(e){var a=e.changedTouches[0];u={x:a.pageX,y:a.pageY},s=u.x-d.x,m=u.y-d.y,f=Math.sqrt(Math.pow(Math.abs(s),2)+Math.pow(Math.abs(m),2)),console.log(f),m<-10&&P()==v()+h()&&(y(),S(),b())}),N()}else{var z=r(o);e(i).next().remove(),e(i).after(z),e(i).next().find("li[data-page='"+o.currentPage+"']").addClass("currentPage"),e(i).next().find("li").on("click",function(){var a=e(this).attr("data-page"),n=l(a,o.pageSize);e(i).attr("data-jsonUrl",n),o.currentPage=parseInt(a),e(this).hasClass("currentPage")||e(i).bindJSON("list",o,t)})}}"function"==typeof t&&(t(),e(i).removeAttr("style"))})},detail:function(t,n){var r=this,o=this.attr("data-jsonUrl");e.getJSON(o,function(t){var n=r.html(),o=/\{(.*?)\}/g,i=n.match(o);e.each(i,function(e,r){strFieldName=r.replace(/\{(.*?)\}/g,"$1"),n=n.replace(r,a(t.data,strFieldName)?t.data[strFieldName]:"<span style='color:red'>无此字段："+strFieldName+"</span>")}),r.html(n)}),"function"==typeof n&&n()}};e.fn.bindJSON=function(){var a=arguments[0];return o[a]?(a=o[a],arguments=Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?e.error("Method "+a+" does not exist on jQuery.bindJSON"):a=o.init,a.apply(this,arguments),this}}(Zepto)}]);